<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Providers | 오늘 나는 최선을 다 했는가?</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/TIL/logo.png">
    <meta name="description" content="⭐️">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.295d7bc5.css" as="style"><link rel="preload" href="/TIL/assets/js/app.a5d3049c.js" as="script"><link rel="preload" href="/TIL/assets/js/4.c90964a3.js" as="script"><link rel="preload" href="/TIL/assets/js/2.ffa2e3a3.js" as="script"><link rel="preload" href="/TIL/assets/js/81.07149609.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.9766f46c.js"><link rel="prefetch" href="/TIL/assets/js/11.38ab8331.js"><link rel="prefetch" href="/TIL/assets/js/12.6d455ea0.js"><link rel="prefetch" href="/TIL/assets/js/13.d2e60e72.js"><link rel="prefetch" href="/TIL/assets/js/14.1e01c32f.js"><link rel="prefetch" href="/TIL/assets/js/15.8ee3bf61.js"><link rel="prefetch" href="/TIL/assets/js/16.c28943cf.js"><link rel="prefetch" href="/TIL/assets/js/17.fdceb0f1.js"><link rel="prefetch" href="/TIL/assets/js/18.47ff19fa.js"><link rel="prefetch" href="/TIL/assets/js/19.4d9a2a45.js"><link rel="prefetch" href="/TIL/assets/js/20.4a4fc06a.js"><link rel="prefetch" href="/TIL/assets/js/21.43d2dff3.js"><link rel="prefetch" href="/TIL/assets/js/22.273436b1.js"><link rel="prefetch" href="/TIL/assets/js/23.5276a847.js"><link rel="prefetch" href="/TIL/assets/js/24.b54571ee.js"><link rel="prefetch" href="/TIL/assets/js/25.0e410122.js"><link rel="prefetch" href="/TIL/assets/js/26.4cd94c55.js"><link rel="prefetch" href="/TIL/assets/js/27.d9fc6d0f.js"><link rel="prefetch" href="/TIL/assets/js/28.127f1351.js"><link rel="prefetch" href="/TIL/assets/js/29.398e72bb.js"><link rel="prefetch" href="/TIL/assets/js/3.da50a5fc.js"><link rel="prefetch" href="/TIL/assets/js/30.d2965602.js"><link rel="prefetch" href="/TIL/assets/js/31.557af5e1.js"><link rel="prefetch" href="/TIL/assets/js/32.901483df.js"><link rel="prefetch" href="/TIL/assets/js/33.cf9a4f1f.js"><link rel="prefetch" href="/TIL/assets/js/34.d936fd76.js"><link rel="prefetch" href="/TIL/assets/js/35.c0e2354c.js"><link rel="prefetch" href="/TIL/assets/js/36.4b174621.js"><link rel="prefetch" href="/TIL/assets/js/37.c26696ec.js"><link rel="prefetch" href="/TIL/assets/js/38.09356d86.js"><link rel="prefetch" href="/TIL/assets/js/39.5b073e3a.js"><link rel="prefetch" href="/TIL/assets/js/40.f6db196d.js"><link rel="prefetch" href="/TIL/assets/js/41.4193180c.js"><link rel="prefetch" href="/TIL/assets/js/42.6ffdcce0.js"><link rel="prefetch" href="/TIL/assets/js/43.1083a118.js"><link rel="prefetch" href="/TIL/assets/js/44.0bca2037.js"><link rel="prefetch" href="/TIL/assets/js/45.52cb52f3.js"><link rel="prefetch" href="/TIL/assets/js/46.b8ea3fa3.js"><link rel="prefetch" href="/TIL/assets/js/47.9d8edc8b.js"><link rel="prefetch" href="/TIL/assets/js/48.5dcf2483.js"><link rel="prefetch" href="/TIL/assets/js/49.651e3e70.js"><link rel="prefetch" href="/TIL/assets/js/5.c7470a6d.js"><link rel="prefetch" href="/TIL/assets/js/50.b543a115.js"><link rel="prefetch" href="/TIL/assets/js/51.6aec8d5f.js"><link rel="prefetch" href="/TIL/assets/js/52.31516e70.js"><link rel="prefetch" href="/TIL/assets/js/53.8eb17279.js"><link rel="prefetch" href="/TIL/assets/js/54.ca9bbebf.js"><link rel="prefetch" href="/TIL/assets/js/55.b7f6b3c0.js"><link rel="prefetch" href="/TIL/assets/js/56.ae5753c6.js"><link rel="prefetch" href="/TIL/assets/js/57.698bc1c9.js"><link rel="prefetch" href="/TIL/assets/js/58.774784db.js"><link rel="prefetch" href="/TIL/assets/js/59.3f7cc6f2.js"><link rel="prefetch" href="/TIL/assets/js/6.14a7eaec.js"><link rel="prefetch" href="/TIL/assets/js/60.8ba623d5.js"><link rel="prefetch" href="/TIL/assets/js/61.ca6cdc71.js"><link rel="prefetch" href="/TIL/assets/js/62.11836466.js"><link rel="prefetch" href="/TIL/assets/js/63.df3178ba.js"><link rel="prefetch" href="/TIL/assets/js/64.a072b044.js"><link rel="prefetch" href="/TIL/assets/js/65.70c2f9ef.js"><link rel="prefetch" href="/TIL/assets/js/66.0d70f74d.js"><link rel="prefetch" href="/TIL/assets/js/67.5c92cb61.js"><link rel="prefetch" href="/TIL/assets/js/68.c2aaf572.js"><link rel="prefetch" href="/TIL/assets/js/69.0538c91e.js"><link rel="prefetch" href="/TIL/assets/js/7.2c7697a1.js"><link rel="prefetch" href="/TIL/assets/js/70.551545bc.js"><link rel="prefetch" href="/TIL/assets/js/71.f4397fbb.js"><link rel="prefetch" href="/TIL/assets/js/72.5130af55.js"><link rel="prefetch" href="/TIL/assets/js/73.9255e536.js"><link rel="prefetch" href="/TIL/assets/js/74.ef63156e.js"><link rel="prefetch" href="/TIL/assets/js/75.d54a87fb.js"><link rel="prefetch" href="/TIL/assets/js/76.1e9d5169.js"><link rel="prefetch" href="/TIL/assets/js/77.bd832585.js"><link rel="prefetch" href="/TIL/assets/js/78.6d8e2fdc.js"><link rel="prefetch" href="/TIL/assets/js/79.25c870ac.js"><link rel="prefetch" href="/TIL/assets/js/8.007b7eee.js"><link rel="prefetch" href="/TIL/assets/js/80.bf61d628.js"><link rel="prefetch" href="/TIL/assets/js/82.eefe1602.js"><link rel="prefetch" href="/TIL/assets/js/83.280c6a79.js"><link rel="prefetch" href="/TIL/assets/js/84.a38ebbbc.js"><link rel="prefetch" href="/TIL/assets/js/85.12e72d66.js"><link rel="prefetch" href="/TIL/assets/js/86.8b87dca5.js"><link rel="prefetch" href="/TIL/assets/js/87.9e8d7da9.js"><link rel="prefetch" href="/TIL/assets/js/88.b8649991.js"><link rel="prefetch" href="/TIL/assets/js/9.74511a11.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.295d7bc5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-58ec7a20><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">오늘 나는 최선을 다 했는가?</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/TIL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/TIL/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/TIL/contact/" class="nav-link">
  Contact
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/TIL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/TIL/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/TIL/contact/" class="nav-link">
  Contact
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Nest</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Documentation</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/nest/docs/introduction.html" class="sidebar-link">INTRODUCTION</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading open"><span>OVERVIEW</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/nest/docs/overview/first-steps.html" class="sidebar-link">First steps</a></li><li><a href="/TIL/nest/docs/overview/controllers.html" class="sidebar-link">Controllers</a></li><li><a href="/TIL/nest/docs/overview/providers.html" aria-current="page" class="active sidebar-link">Providers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#services" class="sidebar-link">Services</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#dependency-injection" class="sidebar-link">Dependency Injection</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#scopes" class="sidebar-link">Scopes</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#custom-providers" class="sidebar-link">Custom providers</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#optional-providers" class="sidebar-link">Optional providers</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#property-based-injection" class="sidebar-link">Property-based injection</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#provider-registration" class="sidebar-link">Provider registration</a></li><li class="sidebar-sub-header"><a href="/TIL/nest/docs/overview/providers.html#manual-instantiation" class="sidebar-link">Manual instantiation</a></li></ul></li><li><a href="/TIL/nest/docs/overview/modules.html" class="sidebar-link">Modules</a></li><li><a href="/TIL/nest/docs/overview/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/TIL/nest/docs/overview/exception-filters.html" class="sidebar-link">Exception filters</a></li></ul></section></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="providers"><a href="#providers" class="header-anchor">#</a> Providers</h1> <p><code>Provider</code>는 Nest의 기본 개념입니다. 대부분의 기본 Nest클래스는 services, repositories, factories, helpers등과 같은 <code>Provider</code>로 취급될 수 있습니다. <code>Provider</code>의 메인 아이디어는 <code>Provider</code>가 dependency로 주입될 수 있다는 것입니다. 즉 객체가 서로 다양한 관계를 형성할 수 있고 객체의 인스턴스를 Nest 런타임 시스템에 위임할 수 있다는 것입니다.</p> <p><img src="https://user-images.githubusercontent.com/63354527/152488743-e8952f71-7855-4bfc-ad1b-58b21b1b802a.png" alt="Components_1"></p> <p>이번 챕터에서는 우리는 간단한 <code>CatsController</code>를 만들 것 입니다. 컨트롤러는 HTTP 요청을 핸들링 할 수 있어야하고 복잡한 일들을 <code>Provider</code>에게 위임 할 수 있어야 합니다. <code>Provider</code>는 plain JavaScript class이고 module에 <code>providers</code>에 선언되어 있습니다.</p> <h2 id="services"><a href="#services" class="header-anchor">#</a> Services</h2> <p><code>CatsService</code>를 만드는 것부터 시작해봅시다. 이 서비스는 데이터 저장 및 검색을 담당하고,<code>CatsController</code>에 의해 사용되도록 디자인 됩니다. 따라서<code>Provider</code>로 정의되기 좋은 후보입니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./interfaces/cat.interface&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsService</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">readonly</span> cats<span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">create</span><span class="token punctuation">(</span>cat<span class="token operator">:</span> Cat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>service를 CLI로 만들고 싶다면 <code>nest g service cats</code>라고 입력하면 됩니다.</p></div> <p>우리의 <code>CatsService</code>는 하나의 속성과 두개의 메서드를 갖는 기본 클래스입니다. 이 클래스의 특징은 <code>@Injectable()</code> 데코레이터를 가진다는 것 입니다. 이 데코레이터는 metadata를 클래스에 붙이고, 이 메타데이터는 <code>CatsService</code>가 Nest IoC container에 의해서 관리되고 있다는 것을 선언합니다. 그건 그렇고, 이 예는 Cat 인터페이스도 사용합니다. 아래와 같습니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>이제 고양이를 검색하는 서비스 클래스가 있으므로 CatsController 내부에서 사용하겠습니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Body <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateCatDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-cat.dto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./interfaces/cat.interface&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;cats&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> catsService<span class="token operator">:</span> CatsService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Cat<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>CatsService</code>는 class constructor에 의해서 주입됩니다. 여기서 우리는 <code>private</code> 구문의 사용에 주목해야합니다. 이 약식을 사용하면 동일한 위치에서 <code>catsService</code> 멤버를 즉시 선언하고 초기화 할 수 있습니다.</p> <h2 id="dependency-injection"><a href="#dependency-injection" class="header-anchor">#</a> Dependency Injection</h2> <p>Nest는 일반적으로 의존성 주입으로 알려진 강력한 디자인 패턴을 기반으로 구축되었습니다. 공식 <a href="https://angular.io/guide/dependency-injection" target="_blank" rel="noopener noreferrer">Angular 문서<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 에서 이 개념에 대한 훌륭한 설명을 읽는 것이 좋습니다.</p> <p>Nestd에서는 TypeScript의 기능, 즉 정적 타입 덕분에 의존성들을 관리하기 쉽습니다. 아래의 예제에서, Nest는 <code>CatsService</code>의 인스턴스를 생성하고 반환하여 <code>catsService</code>를 resolve합니다. (또는 일반적인 싱클톤의 경우 다른 곳에서 이미 요청된 경우 기존 인스턴스를 반환합니다.) 이 의존성은 해결되어 컨트롤러의 생성자로 전달됩니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> catsService<span class="token operator">:</span> CatsService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="scopes"><a href="#scopes" class="header-anchor">#</a> Scopes</h2> <p>Provider들은 일반적으로 어플리케이션 수명 주기와 동시화된 수명(<code>scope</code>)를 갖습니다. 어플리케이션이 bootstrapped 되면 모든 의존성을 해결해야 하므로 모든 Provider를 인스턴스화 해야합니다. 마찬가지로 어플리케이션이 종료되면 각 Provider가 소멸됩니다. 그러나 Provider의 수명을 요청된 범위로 만드는 방법도 있습니다. 자세한 내용은 <a href="https://docs.nestjs.com/fundamentals/injection-scopes" target="_blank" rel="noopener noreferrer">여기<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>를 클릭하세요.</p> <h2 id="custom-providers"><a href="#custom-providers" class="header-anchor">#</a> Custom providers</h2> <p>Nest는 inversion of control 이라고 하는 provider들 간의 관계를 해결해주는 (&quot;IoC&quot;) 컨테이너가 내장되어 있습니다. 이 기능은 위에서 의존성 주입의 기초가 되지만 실제로는 지금까지 설명한 것보다 훨씬 강력합니다. provider를 정의하는 방법은 여러가지 있습니다. 일반 값, 클래스, 비동기 또는 동기 팩토리를 사용할 수 있습니다. 자세한 내용은 <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank" rel="noopener noreferrer">여기<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>를 클릭하세요.</p> <h2 id="optional-providers"><a href="#optional-providers" class="header-anchor">#</a> Optional providers</h2> <p>경우에 따라서 반드시 해결할 필요가 없는 종속성이 있을 수 있습니다. 예를 들어 여러분의 클래스는 configuration object에 의존할 수 있지만, 아무것도 전달되지 않으면 기본 값을 사용해야합니다. 이러한 경우 구성 공급자가 없어도 오류가 발생하지 않기 때문에 종속성은 선택 사항이 됩니다.</p> <p>provider가 optional이라는 것을 나타내기 위해 우리는 <code>@Optional()</code>데코레이터를 생성자에서 사용합니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpService<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Optional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token string">&quot;HTTP_OPTIONS&quot;</span><span class="token punctuation">)</span> <span class="token keyword">private</span> httpClient<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>위의 예에서 사용자 지정 provider를 사용하고 있으며 이것이 <code>HTTP_OPTIONS</code> 사용자 지정 토큰을 포함하는 이유입니다. 이전 예제에서는 생성자의 클래스를 통해 의존성을 나타내는 생성자 기반 주입을 보여줬습니다.</p> <h2 id="property-based-injection"><a href="#property-based-injection" class="header-anchor">#</a> Property-based injection</h2> <p>우리가 지금까지 사용한 기술은 생성자 기반 주입이라고 하는데, 생성자 메서드를 통해 provider가 주입되기 때문입니다. 매우 특정한 경우에는 <code>property-based injection</code>이 유용할 수 있습니다. 예를 들어서 만약 여러분의 top-level 클래스가 하나 또는 여러개의 provider에 의존한다면, 생성자의 하위 클래스에서 <code>super()</code>메서드를 서브 클래스에서 호출하여 위로 전달하는 것은 매우 지루할 수 있습니다. 이를 방지하기 위해 속성 수준에서 <code>@Inject()</code> 데코레이터를 사용할 수 있습니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpService<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token string">&quot;HTTP_OPTIONS&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">readonly</span> httpClient<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="provider-registration"><a href="#provider-registration" class="header-anchor">#</a> Provider registration</h2> <p>이제 우리는 provider를 정의했고, 해당 서비스의 소비자도 있으므로(<code>CatsController</code>) Nest가 주입을 실행할 수 있도록 서비스를 등록해야 합니다.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats/cats.controller&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats/cats.service&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="manual-instantiation"><a href="#manual-instantiation" class="header-anchor">#</a> Manual instantiation</h2> <p>지금까지 Nest가 종속성을 해결하는 대부분의 세부사항을 자동으로 처리하는 방법에 대해 논의했습니다. 특정 상황에서는 기본 제공 의존성 주입 시스템을 벗어나 수동으로 provider를 검색하거나 인스턴스화해야 할 수 있습니다. 우리는 아래에서 그러한 두가지 주제에 대해 간략하게 논의합니다.</p> <p>기존 인스턴스를 가져오거나 provider를 동적으로 인스턴스화하려면 <a href="https://docs.nestjs.com/fundamentals/module-ref" target="_blank" rel="noopener noreferrer">모듈 참조<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>를 사용할 수 있습니다.</p> <p>bootsrap() 함수 내에서 provider를 언드려면 <a href="https://docs.nestjs.com/standalone-applications" target="_blank" rel="noopener noreferrer">독립 실행형 응용 프로그램<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>을 참조하세요.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/nest/docs/overview/controllers.html" class="prev">
        Controllers
      </a></span> <span class="next"><a href="/TIL/nest/docs/overview/modules.html">
        Modules
      </a>
      →
    </span></p></div> <div id="disqus_thread" class="content" data-v-58ec7a20></div></main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.a5d3049c.js" defer></script><script src="/TIL/assets/js/4.c90964a3.js" defer></script><script src="/TIL/assets/js/2.ffa2e3a3.js" defer></script><script src="/TIL/assets/js/81.07149609.js" defer></script>
  </body>
</html>
