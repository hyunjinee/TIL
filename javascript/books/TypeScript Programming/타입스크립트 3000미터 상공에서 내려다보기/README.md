# 타입스크립트: 3000미터 상공에서 내려다보기

## 컴파일러

프로그램은 프로그래머가 작성한 다수의 텍스트 파일로 구성된다. 이 텍스트를 컴파일러라는 특별한 프로그램이 파싱하여 추상문법트리(abstract syntax tree, AST) 라는 자료구조로 변환한다.
AST는 공백,주석,등을 무시한다. 그리고 컴파일러는 다시 AST를 바이트코드라는 하위 수준의 표현으로 변환한다. 바이트코드가 만들어졌으면 런타임이라는 다른 프로그램에 바이트코드를 입력해 평가하고 결과를 얻을 수 있다. 즉, 프로그램을 실행한다는 것은 컴파일러가 소스코드를 파싱해 AST로 만들고,다시 AST를 바이트코드로 변환한 것을 런타임이 평가하도록 지시한다는 의미이다.
타입스크립트가 다른점은 컴파일러가 코드를 바이트코드 대신 자바스크립트 코드로 변환한다는 점이다. 이후로 일반적인 자바스크립트를 실행하듯이 브라우저, nodejs로 실행할 수 있다.
타입스크립트 컴파일러는 AST를 만들어 결과 코드를 내놓기 전에 타입 확인을 거친다.
타입 검사기(typechecker)코드의 타입 안정성을 검증하는 특별한 프로그램
타입스크립트의 마법은 타입 확인 과정에서 일어난다. 타입 확인 덕분에 ts는 프로그램이 개발자의 기대대로 실행 될 수 있게 해주고, 명백한 실수가 들어가지 않게 방지해준다.
보통 자바스크립트 컴파일러와 런타임은 엔지이라는 하나의 프로그램으로 합쳐진다.
개발자는 타입을 명시하거나 타입스크립트가 타입을 추론하도록 할 수 있다. 어노테이션을 이용하면 타입스크립트에 명시적으로 타입을 지정할 수 있다.

```typescript
let a: number = 1;
let b: string = "hyunjin";
let c: boolean[] = [true, false];
```

어노테이션을 사용하지 않으면 타입스크립트가 알아서 타입을 추론한다.
꼭 필요할 때에만 어노테이션을 사용해서 타입스크립트가 알아서 타입을 추론하게 하면 코드의 길이를 줄일 수 있다.

동적 타입 바인딩(dynamic type binding)이란 자바스크립트가 프로그램을 싱행해야만 특정 데이터의 타입을 알 수 있음을 의미한다. 자바스크립트는 프로그램을 실행하기 전에는 타입을 알 수 없다. 타입스크립트는 점진적으로 타입을 확인하는 gradually typed언어이다. 즉, 타입스크립트는 컴파일 타임에 프로그램의 모든 타입을 알고 있을 때 최상의 결과를 보여줄 수 있지만, 프로그램을 컴파일하는데 반드시 모든 타입을 알아야하는 것은 아니다. 타입스크립트는 타입을 지정하지 않은 프로그램이라도 그중 일부 타입을 추론해서 오류를 검출 할 수 있지만, 모든 타입을 알지 못하는 상황에서는 많은 오류가 사용자에게 그대로 노출 될 수 있다. 점진적 타입확인은 타입을 지정하지 않은 기존 자바스크립트 코드를 타입을 사용하는 타입스크립트로 마이그레이션할 때 특히 유용하다. 하지만 코드를 마이그레이션 하는 것이 아니라면, 모든 코드의 타입을 컴파일 타임에 지정하는 것을 목표로 해야한다.
자바스크립트가 영리하게 타입을 변환하려 노력하는 반면 타입스크립트는 유효하지 않은 작업을 반견하는 즉시 불평한다. 자바스크립트는 주어진 상황에서 개발자가 무엇을 의도하는지에 맞춰 변환하려 최대한 노력할 뿐 거의 대부분의 상황에서 타입이 무엇인지 따지지 않는다. 반면 타입스크립트에서는 컴파일 타임에 코드의 타입을 확인하기 때문에 코드를 실행 하지 않고서도 에러가 있음을 알 수 있다. ts는 컴파일 타임에 문법에러와 타입관련에러를 모두 검출한다. 실제 개발자가 코딩을 시작하면 코드 편집기가 이런 종류의 에러를 바로 보여준다.

### tsconfig.json

모든 타입스크립트 프로젝트의 루트 디렉터리에는 tsconfig.json이라는 파일이 존재해야한다. tsconfig.json파일은 타입스크립트의 프로젝트에서 어떤 파일을 컴파일하고 어떤 자바스크립트 버전으로 방출하는지 등을 정의한다.

```json
{
  "compilerOptions": {
    "lib": ["ES2015"],
    "module": "commonjs",
    "outDir": "dist",
    "sourceMap": true,
    "strict": true,
    "target": "ES2015"
  },
  "include": ["src"]
}
```

- include 타입스크립트 파일을 찾을 디렉터리
- lib tsc가 코드 실행 환경에서 이용할 수 있다고 가정하는 API (ES5의 Function.prototype.bind, ES2015의 Object.assign, DOM의 document.querySelector등)
- module TSC가 코드를 컴파일할 대상 모듈 시스템 (CommonJS, SystemJS, ES2015등)
- outDir 생성된 자바스크립트 코드를 출력할 디렉터리
- strict 유효하지 않은 코드를 확인 할 때 가능한 엄격하게 검사, 이 옵션을 이용하면 코드가 적절하게 타입을 갖추도록 강제할 수 있다.
- target TSC가 코드를 컴파일할 자바스크립트버전(ES3, ES5, ES2015, ES2016등)
  TSLint는 선택사항이지만 모든 타입스크립트 프로젝트에 TSLint를 이용해서 일관된 코딩스타일을 사용하도록 권장한다.
